    pat1 = pattern[max(0, W-2)];
