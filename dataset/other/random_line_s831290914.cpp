            res += (long long)ModPow(3, hatena_cnt - 1) * A * C;
