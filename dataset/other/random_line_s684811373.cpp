查询d[k]最大值可以用线段树.
