    while(j < q && p[id[j]].second == i) {
