    int nx = x + dx[dir], ny = y + dy[dir];
