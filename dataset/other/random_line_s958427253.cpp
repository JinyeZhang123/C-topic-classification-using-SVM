        sum[i+1]=sum[i]+(double)(1+p[i])/2.0;
