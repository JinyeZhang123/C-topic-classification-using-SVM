Note that any element of input must not be -1.
