          add += (double)(j + k) * d / 2.0 + (double)k * rem;
