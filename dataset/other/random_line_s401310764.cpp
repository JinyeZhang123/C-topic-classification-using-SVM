    dp[root][i+n+1] = pp(dp[root][i+n+1], pat[i])%P;
