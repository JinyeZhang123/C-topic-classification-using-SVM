    if (r == n) return n-1;
