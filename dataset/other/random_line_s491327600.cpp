        for (int m = M; m >= 1 && !can_pass; --m)
