      k >>= 1; base = 1LL*base*base%P;
