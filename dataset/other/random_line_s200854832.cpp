        if (!uf.same(c, d)) continue;
