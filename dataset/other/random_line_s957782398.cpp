		tmp += mx - tot[n - 1] + std::max(0, mi - tot[n - 2]);
