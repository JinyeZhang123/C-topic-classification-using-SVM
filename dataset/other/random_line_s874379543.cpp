      for(int rmask = 0; rmask < (1 << r); rmask++){
