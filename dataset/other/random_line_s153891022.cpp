    for (int j = 1; j <= M && i + j <= N; j++)
