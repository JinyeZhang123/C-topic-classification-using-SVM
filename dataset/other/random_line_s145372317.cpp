      dist = abs((double)a[i] - halfN);
