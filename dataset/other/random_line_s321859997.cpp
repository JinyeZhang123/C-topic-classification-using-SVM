    while (ip>0 && M[im]*P[ip-1]>x) {
