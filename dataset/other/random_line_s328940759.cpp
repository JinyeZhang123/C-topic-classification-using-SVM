	return t * t % M * (q%2 ? p : 1) % M;
