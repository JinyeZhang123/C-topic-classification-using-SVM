T mod_pow(T x, T n, const T &p) {
