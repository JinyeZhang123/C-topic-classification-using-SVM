      cur_len = ( i+1 + 2*k < p.size() ) ? p[i+1+2*k]-p[i] : n-p[i];
