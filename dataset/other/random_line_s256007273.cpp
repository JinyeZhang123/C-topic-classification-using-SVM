LL calc(int dir, int l, int r) {
