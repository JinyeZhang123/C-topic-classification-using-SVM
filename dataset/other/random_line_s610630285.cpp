    double ans = a*a + b*b - 2*a*b*cos(th-tm);
