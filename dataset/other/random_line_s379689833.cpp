		base += std::min(ret, val[i]), sum += ret + val[i];
