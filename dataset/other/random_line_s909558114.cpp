        next = max(0, index - M);
