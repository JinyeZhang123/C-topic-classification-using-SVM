    cum[0]=((double)P[0]+1)/2;
