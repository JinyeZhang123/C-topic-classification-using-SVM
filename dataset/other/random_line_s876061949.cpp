            int r_id = upper_bound(X.begin(), X.end(), right) - X.begin();
