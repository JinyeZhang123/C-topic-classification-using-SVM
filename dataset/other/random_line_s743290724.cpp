            limits[i].second = max(limits[i-1].second - r[i] + r[i-1], 0LL);
