            i += N + same[i%N] - i%N;
