      for (int t = min(sum / 2, u + 1); t >= 0; --t) {
