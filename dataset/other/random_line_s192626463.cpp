        tmp -= c[i]*(d-last[i]);
