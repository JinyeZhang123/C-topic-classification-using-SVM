      for(q = r ? 0 : 1;q <= n && q <= p;q++){
