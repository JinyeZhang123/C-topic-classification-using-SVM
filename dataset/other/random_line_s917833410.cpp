            head += j - table[j], j = max(table[j], 0);
