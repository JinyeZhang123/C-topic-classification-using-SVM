    int need = 2*(N-1-M) - (N-M), lim = N-M-2;
