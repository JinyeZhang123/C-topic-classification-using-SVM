        int val = (w - a[u] - a[v]) * (h[u] & 1 ? 1 : -1);
