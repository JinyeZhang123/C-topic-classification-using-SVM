  b &= ((1LL << (r + 1)) - 1);
