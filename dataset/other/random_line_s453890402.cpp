    return idx + m - n >= m - 1 ? idx + m - n : idx + m;
