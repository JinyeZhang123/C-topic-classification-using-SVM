      r=min(w,r+1);
