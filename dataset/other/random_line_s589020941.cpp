        a[i+1] -= min(rem, a[i+1]);
