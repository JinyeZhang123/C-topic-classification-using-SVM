	while (pre[p]!=ls+1)putchar(s[pre[p]]),p=pre[p];
