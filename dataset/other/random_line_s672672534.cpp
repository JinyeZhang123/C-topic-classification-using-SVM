    diff = std::max(diff, -diff);
