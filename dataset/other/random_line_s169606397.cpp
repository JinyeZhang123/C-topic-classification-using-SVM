            line = next_phase(line, dir, q.t);
