  int pre = p > 1 ? p - 1 : n;
