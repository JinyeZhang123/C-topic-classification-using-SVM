    for (int p = 0; p < P; p++) res += val[p] * (val[p] - 1) / 2;
