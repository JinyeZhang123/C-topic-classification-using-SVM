  for (int d = 1; d * d <= N; d++) {
