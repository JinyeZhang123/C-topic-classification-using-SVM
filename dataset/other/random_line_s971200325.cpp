		while (k > 1 && det(ret[k - 1] - ret[k - 2], ps[i] - ret[k - 1]) <= 0)
