        for (int xi = 0; xi < W; ++xi) {
