        B[p.second] -= diff*n;
