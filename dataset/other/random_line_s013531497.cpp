                r = std::min(r, -d[i] / z[i] - 1);
