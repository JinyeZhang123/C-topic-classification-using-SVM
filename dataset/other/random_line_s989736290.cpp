    d =min(d, p+r);
