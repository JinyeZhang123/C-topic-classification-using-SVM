      if (ni < 0 || nj < 0 || ni >= h || nj >= w) continue;
