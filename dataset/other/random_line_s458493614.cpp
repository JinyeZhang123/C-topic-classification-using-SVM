    for (int i = n; i >= 1 && q[i].r == q[n].r; i--)
