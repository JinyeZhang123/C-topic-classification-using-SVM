      a[i+1] = lmax(a[i+1] - b[i], 0);
