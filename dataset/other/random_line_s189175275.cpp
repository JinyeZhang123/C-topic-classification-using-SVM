    int nxt = (cur + 1) % K;
