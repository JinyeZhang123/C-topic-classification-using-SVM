        mi = min(w[i] + last_e - e[i], mi);
