            for (auto p : diag[d]) {
