    state = (int*)malloc(sizeof(int)*(numdata+1));
