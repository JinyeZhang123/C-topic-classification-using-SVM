            temp += d[r[i-1]][r[i]];
