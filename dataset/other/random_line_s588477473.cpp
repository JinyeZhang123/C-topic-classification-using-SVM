      if (abs(cnts[i] - cnts[j]) > 1) is_valid = false;
