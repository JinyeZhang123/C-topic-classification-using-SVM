    current = Compute(true, false, k + 1, r) + Compute(false, true, k, r) + PartialSum(l - r) * (2 * r + 1);
