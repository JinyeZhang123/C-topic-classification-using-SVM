        while (3 * d + 1 <= n && pos < n) {
