  while(lidx >= 0 && ridx < N) {
