  else if (X <= 1 + a[N-1] + 1 + a[N-1]) return p[N-1] + 1 + f(N-1, X - 1 - a[N-1] - 1);
