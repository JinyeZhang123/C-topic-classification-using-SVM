        for (int i = p + 1; i <= min(N, p + M); i++) {
