            speed[ts] = min(speed[ts], sp + (l - ts)/2.0);
