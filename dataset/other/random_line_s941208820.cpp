    min_node[i] = max(0LL, mi - leaf[i]);
