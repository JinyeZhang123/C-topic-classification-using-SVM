            if (ny < 0 || ny >= h) continue;
