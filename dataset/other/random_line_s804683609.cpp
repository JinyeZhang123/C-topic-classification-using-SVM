    res[v] = lower_bound(dp, dp+n, INF) - dp;
