			ret += min(a[ptr] - x, x - a[ptr + n - 1] + d);
