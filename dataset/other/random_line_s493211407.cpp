    h = min (q*2, h);
