template<class T>inline T emod(T a, T p) { return (a%p + p) % p;}