template<class T> T gabs(const T& x) { return max(x, -x); }