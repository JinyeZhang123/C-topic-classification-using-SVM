  REP(i, N){
        while (tmp < N-1 && X[tmp+1] 